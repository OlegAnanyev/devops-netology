# Домашнее задание к занятию "10.06. Инцидент-менеджмент"

## Задание 1

Составьте постмотрем, на основе реального сбоя системы Github в 2018 году.

Информация о сбое доступна [в виде краткой выжимки на русском языке](https://habr.com/ru/post/427301/) , а
также [развёрнуто на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).

----------


Краткое описание инцидента
21 октября в 22:52 UTC после техобслуживания сетевого оборудования на 43 секунды прервалась связь между US East Coast network hub и US East Coast data center. Это вызвало цепь событий, которая привела к частичной недоступности сервисов GitHub в течение 24 часов и 11 минут.

Предшествующие события
Техническое обслуживание оптического сетевого оборудования.

Причина инцидента
Потеря согласованности между БД в датацентре на Восточном и Западном побережье.

Воздействие
В течение 24 часов и 11 минут у 100% пользователей: было невозможно создать issue, оставить комментарий, не работали хуки и сайты, хостящиеся на GitHub Pages.

Обнаружение
В 21.10.18 в 22:54 UTC дежурные инженеры получили оповещение от систем мониторинга и в 23:07 передали информацию координатору инцидента.

Реакция
Дежурные инженеры и команда по реагированию на инцидент смогли вернуть согласованность кластерам БД и восстановить работу всех сервисов за 24 часа и 11 минут.

Восстановление
БД в датацентре на Восточном побережье была восстановлена из бэкапа, вручную сконфигурирована как primary для всех кластеров и топология репликации была перестроена. Пользовательские данные не пострадали.

Таймлайн
21.10.2008 22:52 UTC: потеря связи между US East Coast network hub и US East Coast data center
21.10.2008 22:54 UTC: дежурные инженеры получают оповещения от системы мониторинга
21.10.2008 23:02 UTC: появляется понимание, что топология кластера БД в некорректном состоянии
21.10.2008 23:07 UTC: для предотвращения ухудшения ситуации внтуренние обработчики переведены в режим read-only
21.10.2008 23:09 UTC: статус работоспособности  GitHub -- жёлтый, информация передана ответственному координатору инцидента
21.10.2008 23:11 UTC: координатор инцидента принял решение установить статус -- красный
21.10.2008 23:13 UTC: все сервисы переведены в режим read-only для восстановления работоспособности
21.10.2008 23:19 UTC: отключены webhook's и Github Pages
22.10.2008 00:05 UTC: принято решение восстановить базу из бэкапа и провести синхронизацию кластера
22.10.2008 00:41 UTC: запущено восстановление из бэкапа
22.10.2008 06:51 UTC: часть БД на Восточном побережье восстановлены, идёт репликация с Западным
22.10.2008 07:46 UTC: все БД на Восточном побережье восстановлены
22.10.2008 16:24 UTC: восстановление завершено, репликация завершена, топология восстановлена
22.10.2008 16:45 UTC: начинает обрабатываться очередь из скопившихся webhook'ов
22.10.2008 23:03 UTC: сервис работает в штатном режиме

Последующие действия
Сделаны выводы и запланированы изменения в системе: оркестратор не должен меня на primary БД в другом регионе, чтобы не нарушать топологию; улучшение системы мониторинга для сбора более точной и чёткой инормации о происходящих ошибках; улучшение архитектуры системы датацентров с целью обеспечения дополнительной избыточности хранимых данных для большей надёжности; проведение превентиных проверок стабильности системы для предотвращения проблем; появилось понимание, что существующие механизмы обеспечения бесперебойной работоспособности GitHub уже недостаточны для текущего уровня развития.
