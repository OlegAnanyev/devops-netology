# Домашнее задание к занятию "11.01 Введение в микросервисы"

Вас пригласили консультантом, в крупную компанию, которая решила построить Микросервисную Платформу для внутренней разработки.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.


## Задача 1: Обеспечить разработку

Предложите решение для обеспечения процесса разработки: хранение исходного кода, непрерывная интеграция и непрерывная поставка. 
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- Облачная система;
- Система контроля версий Git;
- Репозиторий на каждый сервис;
- Запуск сборки по событию из системы контроля версий;
- Запуск сборки по кнопке с указанием параметров;
- Возможность привязать настройки к каждой сборке;
- Возможность создания шаблонов для различных конфигураций сборок;
- Возможность безопасного хранения секретных данных: пароли, ключи доступа;
- Несколько конфигураций для сборки из одного репозитория;
- Кастомные шаги при сборке;
- Собственные докер образы для сборки проектов;
- Возможность развернуть агентов сборки на собственных серверах;
- Возможность параллельного запуска нескольких сборок;
- Возможность параллельного запуска тестов;

Обоснуйте свой выбор.

```
В данном случае, я предлагаю использовать GitLab. Это решение удовлетворяет
всем поставленным требованиям и уже включает систему для построения CI/CD-пайплайнов,
не требуя для этого сторонних инструментов. Альтернативой может выступать GitHub с его
системой GitHub Actions, но с GitLab я знаком лучше и лично мне он нравится больше за
счёт своей гибкости и простоты.
```


## Задача 2: Логи

Предложите решение для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- Сбор логов в центральное хранилище со всех хостов обслуживающих систему;
- Минимальные требования к приложениям, сбор логов из stdout;
- Гарантированная доставка логов до центрального хранилища;
- Обеспечение поиска и фильтрации по записям логов;
- Обеспечение пользовательского интерфейса с возможностью предоставления доступа разработчикам для поиска по записям логов;
- Возможность дать ссылку на сохраненный поиск по записям логов;

Обоснуйте свой выбор.

```
Здесь, на мой взгляд, выбор практически очевиден -- ELK-стек. На данный момент это
фактически стандарт для построения системы сбора логов. За счёт мощности и
масштабируемости позволяет обрабатывать огромные объёмы логов, при этом в базовом
виде запустить систему довольно легко, а тонкую настройку можно проводить опираясь
на официальную документацию и крупное коммьюнити пользователей данной системы. 
Учитывая требования гарантированной доставки логов, в качестве протокола транспортного
уровня следует использовать TCP.
```

## Задача 3: Мониторинг

Предложите решение для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- Сбор метрик со всех хостов, обслуживающих систему;
- Сбор метрик состояния ресурсов хостов: CPU, RAM, HDD, Network;
- Сбор метрик потребляемых ресурсов для каждого сервиса: CPU, RAM, HDD, Network;
- Сбор метрик, специфичных для каждого сервиса;
- Пользовательский интерфейс с возможностью делать запросы и агрегировать информацию;
- Пользовательский интерфейс с возможность настраивать различные панели для отслеживания состояния системы;

Обоснуйте свой выбор.

```
В плане систем мониторинга есть из чего выбрать и что скомбинировать, но я предлагаю
использовать Prometheus для сбора метрик и Grafana для предоставления интерфейса для
просмотра, агрегации и визуализации собранной информации. Prometheus позволяет собирать
метрики с различных хостов (Linux, Windows, контейнеризирвоанные приложения, виртуальные
и физическеие машины), имеет экспортёры с преднастроенными метриками для огромного количества
приложений и сервисов, к томуже многие популярные сервисы и ПО "из коробки" умеют
экспортировать метрики в подходящем для Prometheus формате.
Grafana отлично справляется с визуальной частью, позволяет строить наглядные и красивые дашборды.
```
## Задача 4: Кластеризация * (необязательная)

Предложите решение для обеспечения развертывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- Поддержка контейнеров;
- Обеспечивать обнаружение сервисов и маршрутизацию запросов;
- Обеспечивать возможность горизонтального масштабирования;
- Обеспечивать возможность автоматического масштабирования;
- Обеспечивать явное разделение ресурсов доступных извне и внутри системы;
- Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п.

Обоснуйте свой выбор.
